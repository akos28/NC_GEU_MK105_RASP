<!DOCTYPE html>
<html lang="en">
<head>
    <title>Team Rasp | Analytics</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">

    <link rel="icon" type="image/x-icon" href="favico.ico">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300&display=swap" rel="stylesheet"> 
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,200;0,300;0,400;0,600;0,700;0,900;1,200;1,300;1,400;1,600;1,700;1,900&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="assets/css/styles.css">
    
</head>

<body class="body">
  

    <nav class="navbar navbar-expand-lg navbar-light">
        <a class="navbar-brand, left" href="index.html">
            <img src="assets/img/Logo-DarkBlue.png" alt="Logo" width ="85px" height="75px">
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
    
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto nav-fill w-100">
                <li class="nav-item">
                    <a class="nav-link" href="index.html">HOME</a>
                </li>
                <li class="nav-item active">
                    <a class="nav-link" href="analytics.html">ANALYTICS</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="ideas.html">IDEAS</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="working.html">HOW IT WORKS</a>
                </li>
                <li class="nav-item active">
                    <a class="nav-link" href="team.html">TEAM</a>
                </li>
            </ul>
        </div>
    </nav>

    <div class="container-fluid">
        <div style="text-align:center;">
            <h2 style="margin-top:3em;margin-bottom:3em;">ANALYTICS</h2>
        </div>

        <div class="row">
            <div class="col-xl-1"></div>
            <!-- 1 -->
            <div class="col-xl-4 analytics-card">
                <div class="card shadow" id="card-1">
                    <div class="fl-gh">
                        <div id="fl-gh-1" class=" zoom-in flourish-embed flourish-chart"></div>
                    </div>
                </div>
            </div>
            <div class="col-xl-1"></div>
            <!-- 2 -->
            <div class="col-xl-4 analytics-card">
                <div class="card shadow" id="card-2">
                    <div class="fl-gh">
                        <div id="fl-gh-2" class=" zoom-in flourish-embed flourish-chart"></div>
                    </div>
                </div>
            </div>
            <div class="col-xl-1"></div>
        </div>

        <div class="row">
            <div class="col-xl-4"></div>
            <!-- 3 -->
            <div class="col-xl-4 analytics-card">
                <div class="card shadow" id="card-3">
                    <div class="fl-gh">
                        <div id="fl-gh-3" class=" zoom-in flourish-embed flourish-chart"></div>
                    </div>
                </div>
            </div>
            <div class="col-xl-4"></div>
        </div>

        <div class="row">
            <div class="col-xl-1"></div>
            <!-- 4 -->
            <div class="col-xl-4 analytics-card">
                <div class="card shadow" id="card-4">
                    <div class="fl-gh">
                        <div id="fl-gh-4" class=" zoom-in flourish-embed flourish-chart"></div>
                    </div>
                </div>
            </div>
            <div class="col-xl-1"></div>
            <!-- 5 -->
            <div class="col-xl-4 analytics-card">
                <div class="card shadow" id="card-5">
                    <div class="fl-gh">
                        <div id="fl-gh-5" class=" zoom-in flourish-embed flourish-chart"></div>
                    </div>
                </div>
            </div>
            <div class="col-xl-1"></div>
        </div>

        <div class="row">
            <div class="col-xl-4"></div>
            <!-- 6 -->
            <div class="col-xl-4 analytics-card">
                <div class="card shadow" id="card-6">
                    <div class="fl-gh">
                        <div id="fl-gh-6" class=" zoom-in flourish-embed flourish-chart"></div>
                    </div>
                </div>
            </div>
            <div class="col-xl-4"></div>
        </div>

        <div class="row">
            <div class="col-xl-1"></div>
            <!-- 7 -->
            <div class="col-xl-4 analytics-card">
                <div class="card shadow" id="card-7">
                    <div class="fl-gh">
                        <div id="fl-gh-7" class=" zoom-in flourish-embed flourish-chart"></div>
                    </div>
                </div>
            </div>
            <div class="col-xl-1"></div>
            <!-- 8 -->
            <div class="col-xl-4 analytics-card">
                <div class="card shadow" id="card-8">
                    <div class="fl-gh">
                        <div id="fl-gh-8" class=" zoom-in flourish-embed flourish-chart"></div>
                    </div>
                </div>
            </div>
            <div class="col-xl-1"></div>
        </div>

        <div class="row">
            <div class="col-xl-4"></div>
            <!-- 9 -->
            <div class="col-xl-4 analytics-card">
                <div class="card shadow" id="card-9">
                    <div class="fl-gh">
                        <div id="fl-gh-9" class=" zoom-in flourish-embed flourish-chart"></div>
                    </div>
                </div>
            </div>
            <div class="col-xl-4"></div>
        </div>

        <div class="row">
            <div class="col-xl-1"></div>
            <!-- 10 -->
            <div class="col-xl-4 analytics-card">
                <div class="card shadow" id="card-10">
                    <div class="fl-gh">
                        <div id="fl-gh-10" class=" zoom-in flourish-embed flourish-chart"></div>
                    </div>
                </div>
            </div>
            <div class="col-xl-1"></div>
            <!-- 11 -->
            <div class="col-xl-4 analytics-card">
                <div class="card shadow" id="card-11">
                    <div class="fl-gh">
                        <div id="fl-gh-11" class=" zoom-in flourish-embed flourish-chart"></div>
                    </div>
                </div>
            </div>
            <div class="col-xl-1"></div>
        </div>

        <div class="row">
            <div class="col-xl-4"></div>
            <!-- 12 -->
            <div class="col-xl-4 analytics-card">
                <div class="card shadow" id="card-12">
                    <div class="fl-gh">
                        <div id="fl-gh-12" class=" zoom-in flourish-embed flourish-chart"></div>
                    </div>
                </div>
            </div>
            <div class="col-xl-4"></div>
        </div>

        <div class="row">
            <div class="col-xl-1"></div>
            <!-- 13 -->
            <div class="col-xl-4 analytics-card">
                <div class="card shadow" id="card-13">
                    <div class="fl-gh">
                        <div id="fl-gh-13" class=" zoom-in flourish-embed flourish-chart"></div>
                    </div>
                </div>
            </div>
            <div class="col-xl-1"></div>
            <!-- 14 -->
            <div class="col-xl-4 analytics-card">
                <div class="card shadow" id="card-14">
                    <div class="fl-gh">
                        <div id="fl-gh-14" class=" zoom-in flourish-embed flourish-chart"></div>
                    </div>
                </div>
            </div>
            <div class="col-xl-1"></div>
        </div>

    </div>

    <script>
        let bloop = {
            "links" : {
                "1" : "3357665",
                "2" : "3354906",
                "3" : "3360711",
                "4" : "3360930",
                "5" : "3364182",
                "6" : "3361330",
                "7" : "3361498",
                "8" : "3363781",
                "9" : "3363488",
                "10" : "3364076",
                "11" : "3363628",
                "12" : "3363780",
                "13" : "3361311",
                "14" : "3361821"
            },
            "order" : []
        }

        let order_govt = ["1", "2", "3", "4", "5", "6", "7", "8"];
        let order_stdt = ["9", "10", "11", "12", "13", "14"];
        let order_edin = ["10", "9", "11", "14"];
        let order_jose = ["9", "11", "10", "7", "1"];
        let order_othr = ["6", "7", "10", "9", "11", "1", "12", "8"];

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function vizzy(){
            let profession = "Other";
            if(typeof(Storage) !== "undefined") {
                if (localStorage.profession){
                    profession = localStorage.profession;
                }
            } else{
                alert("We're sorry, but your browser doesn't support a feature we use. ERR: LS02");
            }

            switch (profession){
                case "Government":
                    bloop.order = [...order_govt];
                    break;
                case "Student":
                    bloop.order = [...order_stdt];
                    break;
                case "Educational_Institution":
                    bloop.order = [...order_edin];
                    break;
                    case "Job_Seeker":
                    bloop.order = [...order_jose];
                    break;
                    case "Other":
                    bloop.order = [...order_othr];
                    break;
            }

            let order_glob = [];
            for (i = 1; i < Object.keys(bloop.links).length+1; ++i){
                order_glob.push(String(i));
            }

            let order_rand = order_glob.filter(x => !bloop.order.includes(x));
            shuffleArray(order_rand);

            for (i = 0; i < bloop.order.length; ++i){
                stringi = new String(i+1);
                elem = "fl-gh-"+stringi;
                data_url = "https://flo.uri.sh/visualisation/"+bloop["links"][stringi]+"/embed";
                data_src = "visualisation/"+ bloop["links"][stringi];
                document.getElementById(elem).setAttribute("data-url", data_url);
                document.getElementById(elem).setAttribute("data-src", data_src);
            }

            console.log(order_rand)

            for (i = bloop.order.length; i < order_rand.length + bloop.order.length; ++i){
                stringi = new String(i+1);
                elem = "fl-gh-"+stringi;
                console.log(i, bloop.order.length, order_rand[i-bloop.order.length]);
                data_url = "https://flo.uri.sh/visualisation/"+bloop["links"][order_rand[i-bloop.order.length]]+"/embed";
                data_src = "visualisation/"+ bloop["links"][order_rand[i-bloop.order.length]];
                console.log(data_src, data_url);
                document.getElementById(elem).setAttribute("data-url", data_url);
                document.getElementById(elem).setAttribute("data-src", data_src);
            }
        }

        window.onload = vizzy();
    </script>
    <script src="https://public.flourish.studio/resources/embed.js"></script>
</body>
</html>